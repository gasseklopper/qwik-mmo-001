import{getNotFound as fe}from"./@qwik-city-not-found-paths.js";import{isStaticPath as ue}from"./@qwik-city-static-paths.js";import{_ as de,a as he,v as pe,q as me}from"./assets/@qwik-city-plan-1b8fed21.js";import{s as ge,r as ye,m as we}from"./assets/entry.ssr-0b78381e.js";var Z=class extends Error{constructor(e,r){super(r),this.status=e}};function be(e,r){let t="Server Error";return r!=null&&(typeof r.message=="string"?t=r.message:t=String(r)),"<html>"+E(e,t)+"</html>"}function E(e,r){typeof e!="number"&&(e=500),typeof r=="string"?r=xe(r):r="";const t=typeof r=="string"?"600px":"300px",a=e>=500?Re:_e;return`
<head>
  <meta charset="utf-8">
  <meta http-equiv="Status" content="${e}">
  <title>${e} ${r}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <style>
    body { color: ${a}; background-color: #fafafa; padding: 30px; font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, Roboto, sans-serif; }
    p { max-width: ${t}; margin: 60px auto 30px auto; background: white; border-radius: 4px; box-shadow: 0px 0px 50px -20px ${a}; overflow: hidden; }
    strong { display: inline-block; padding: 15px; background: ${a}; color: white; }
    span { display: inline-block; padding: 15px; }
  </style>
</head>
<body><p><strong>${e}</strong> <span>${r}</span></p></body>
`}var Se=/[&<>]/g,xe=e=>e.replace(Se,r=>{switch(r){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";default:return""}}),_e="#006ce9",Re="#713fc2",ke={lax:"Lax",none:"None",strict:"Strict"},Te={seconds:1,minutes:1*60,hours:1*60*60,days:1*60*60*24,weeks:1*60*60*24*7},Ae=(e,r,t)=>{const a=[`${e}=${r}`];typeof t.domain=="string"&&a.push(`Domain=${t.domain}`),typeof t.maxAge=="number"?a.push(`Max-Age=${t.maxAge}`):Array.isArray(t.maxAge)?a.push(`Max-Age=${t.maxAge[0]*Te[t.maxAge[1]]}`):typeof t.expires=="number"||typeof t.expires=="string"?a.push(`Expires=${t.expires}`):t.expires instanceof Date&&a.push(`Expires=${t.expires.toUTCString()}`),t.httpOnly&&a.push("HttpOnly"),typeof t.path=="string"&&a.push(`Path=${t.path}`);const n=Pe(t.sameSite);return n&&a.push(`SameSite=${n}`),t.secure&&a.push("Secure"),a.join("; ")},De=e=>{const r={};if(typeof e=="string"&&e!==""){const t=e.split(";");for(const a of t){const n=a.indexOf("=");n!==-1&&(r[decodeURIComponent(a.slice(0,n).trim())]=decodeURIComponent(a.slice(n+1).trim()))}}return r};function Pe(e){if(e===!0)return"Strict";if(e===!1)return"None";if(e)return ke[e]}var T=Symbol("request-cookies"),z=Symbol("response-cookies"),x=Symbol("live-cookies"),ee,te,Me=class{constructor(e){this[ee]={},this[te]={},this[T]=De(e),this[x]={...this[T]}}get(e,r=!0){const t=this[r?x:T][e];return t?{value:t,json(){return JSON.parse(t)},number(){return Number(t)}}:null}getAll(e=!0){return Object.keys(this[e?x:T]).reduce((r,t)=>(r[t]=this.get(t),r),{})}has(e,r=!0){return!!this[r?x:T][e]}set(e,r,t={}){this[x][e]=typeof r=="string"?r:JSON.stringify(r);const a=typeof r=="string"?r:encodeURIComponent(JSON.stringify(r));this[z][e]=Ae(e,a,t)}delete(e,r){this.set(e,"deleted",{...r,maxAge:0}),this[x][e]=null}headers(){return Object.values(this[z])}};ee=z,te=x;var We=(e,r)=>{const t=r.headers();if(t.length>0){const a=new Headers(e);for(const n of t)a.append("Set-Cookie",n);return a}return e},N=class{},M=class extends N{},B=new WeakMap,J="qaction",Oe="qfunc";function $e(e){const{url:r,params:t,request:a,status:n,locale:i}=e,o={};a.headers.forEach((u,h)=>o[h]=u);const s=e.sharedMap.get(C),f=e.sharedMap.get(oe),c=e.sharedMap.get(Ke);return{url:new URL(r.pathname+r.search,r).href,requestHeaders:o,locale:i(),nonce:c,qwikcity:{ev:e,params:{...t},loadedRoute:Ye(e),response:{status:n(),loaders:I(e),action:s,formData:f}}}}var ve=(e,r,t,a,n)=>{const i=[],o=[],s=[],f=!!(r&&Qe(r[1]));return e&&G(i,o,s,e,f,t),r&&(a&&(t==="POST"||t==="PUT"||t==="PATCH"||t==="DELETE")&&s.unshift(ze),f&&(t==="POST"&&s.push(Le),s.push(He),s.push(Fe)),s.push(Ue),G(i,o,s,r[1],f,t),f&&(s.push(Ce(i,o)),s.push(n))),s},G=(e,r,t,a,n,i)=>{for(const o of a){typeof o.onRequest=="function"?t.push(o.onRequest):Array.isArray(o.onRequest)&&t.push(...o.onRequest);let s;switch(i){case"GET":{s=o.onGet;break}case"POST":{s=o.onPost;break}case"PUT":{s=o.onPut;break}case"PATCH":{s=o.onPatch;break}case"DELETE":{s=o.onDelete;break}case"OPTIONS":{s=o.onOptions;break}case"HEAD":{s=o.onHead;break}}if(typeof s=="function"?t.push(s):Array.isArray(s)&&t.push(...s),n){const f=Object.values(o).filter(u=>K(u,"server_loader"));e.push(...f);const c=Object.values(o).filter(u=>K(u,"server_action"));r.push(...c)}}},K=(e,r)=>e&&typeof e=="function"&&e.__brand===r;function Ce(e,r){return async t=>{if(t.headersSent){t.exit();return}const{method:a}=t,n=I(t),i=L(t)==="dev",o=t[v];if(i&&a==="GET"&&t.query.has(J)&&console.warn(`Seems like you are submitting a Qwik Action via GET request. Qwik Actions should be submitted via POST request.
Make sure your <form> has method="POST" attribute, like this: <form method="POST">`),a==="POST"){const s=t.query.get(J);if(s){const f=globalThis._qwikActionsMap,c=r.find(u=>u.__id===s)??(f==null?void 0:f.get(s));if(c){t.sharedMap.set(C,s);const u=await t.parseBody();if(!u||typeof u!="object")throw new Error("Expected request data to be an object");const h=await X(t,c.__validators,u,i);if(!h.success)n[s]=t.fail(h.status??500,h.error);else{const m=i?await O(t,c.__qrl.getSymbol().split("_",1)[0],()=>c.__qrl.call(t,h.data,t)):await c.__qrl.call(t,h.data,t);i&&W(o,m,c.__qrl),n[s]=m}}}}e.length>0&&await Promise.all(e.map(s=>{const f=s.__id;return n[f]=X(t,s.__validators,void 0,i).then(c=>c.success?i?O(t,s.__qrl.getSymbol().split("_",1)[0],()=>s.__qrl.call(t,t)):s.__qrl.call(t,t):t.fail(c.status??500,c.error)).then(c=>(typeof c=="function"?n[f]=c():(i&&W(o,c,s.__qrl),n[f]=c),c))}))}}async function X(e,r,t,a){let n={success:!0,data:t};if(r)for(const i of r)if(a?n=await O(e,"validator$",()=>i.validate(e,t)):n=await i.validate(e,t),n.success)t=n.data;else return n;return n}function Ie(e){return e&&typeof e=="object"&&Symbol.asyncIterator in e}async function Le(e){const r=e.query.get(Oe);if(r&&e.request.headers.get("X-QRL")===r&&e.request.headers.get("Content-Type")==="application/qwik-json"){e.exit();const t=L(e)==="dev",a=e[v],n=await e.parseBody();if(Array.isArray(n)){const[i,...o]=n;if(je(i)&&i.getHash()===r){let s;try{t?s=await O(e,`server_${i.getSymbol()}`,()=>i.apply(e,o)):s=await i.apply(e,o)}catch(f){e.headers.set("Content-Type","application/qwik-json"),e.send(500,await a._serializeData(f,!0));return}if(Ie(s)){e.headers.set("Content-Type","text/qwik-json-stream");const c=e.getWritableStream().getWriter();for await(const u of s){t&&W(a,u,i);const h=await a._serializeData(u,!0);if(e.signal.aborted)break;await c.write($.encode(`${h}
`))}c.close()}else{W(a,s,i),e.headers.set("Content-Type","application/qwik-json");const f=await a._serializeData(s,!0);e.send(200,f)}return}}throw e.error(500,"Invalid request")}}function He(e){const r=U(e),{basePathname:t,pathname:a,url:n,sharedMap:i}=e;if(!i.has(A)&&a!==t&&!a.endsWith(".html")){if(r){if(!a.endsWith("/"))throw e.redirect(302,a+"/"+n.search)}else if(a.endsWith("/"))throw e.redirect(302,a.slice(0,a.length-1)+n.search)}}function W(e,r,t){try{e._verifySerializable(r,void 0)}catch(a){throw a instanceof Error&&t.dev&&(a.loc=t.dev),a}}var je=e=>typeof e=="function"&&typeof e.getSymbol=="function";function Qe(e){const r=e[e.length-1];return r&&typeof r.default=="function"}function re(e,r){return e.pathname.endsWith(R)?e.pathname.slice(0,-R.length+(r?1:0))+e.search:e.pathname}var $=new TextEncoder;function ze(e){if(Je(e.request.headers,"application/x-www-form-urlencoded","multipart/form-data","text/plain")){const t=e.request.headers.get("origin"),a=e.url.origin;if(t!==a)throw e.error(403,`CSRF check failed. Cross-site ${e.method} form submissions are forbidden.
The request origin "${t}" does not match the server origin "${a}".`)}}function Ne(e){return async r=>{if(r.headersSent||r.sharedMap.has(A))return;r.request.headers.forEach((h,m)=>h);const a=r.headers;a.has("Content-Type")||a.set("Content-Type","text/html; charset=utf-8");const n=U(r),{readable:i,writable:o}=new TextEncoderStream,s=r.getWritableStream(),f=i.pipeTo(s,{preventClose:!0}),c=o.getWriter(),u=r.status();try{const h=L(r)==="static",m=await e({base:r.basePathname+"build/",stream:c,serverData:$e(r),containerAttributes:{["q:render"]:h?"static":""}}),p={loaders:I(r),action:r.sharedMap.get(C),status:u!==200?u:200,href:re(r.url,n)};typeof m.html=="string"&&await c.write(m.html),r.sharedMap.set("qData",p)}finally{await c.ready,await c.close(),await f}await s.close()}}async function Ue(e){if(e.sharedMap.has(A)){try{await e.next()}catch(i){if(!(i instanceof M))throw i}if(e.headersSent)return;const t=e.status(),a=e.headers.get("Location");if(t>=301&&t<=308&&a){const i=Be(a);if(i){e.headers.set("Location",i),e.getWritableStream().close();return}else e.status(200),e.headers.delete("Location")}}}async function Fe(e){if(e.sharedMap.has(A)){if(await e.next(),e.headersSent||e.exited)return;const t=e.status(),a=e.headers.get("Location"),n=U(e);e.request.headers.forEach((c,u)=>c),e.headers.set("Content-Type","application/json; charset=utf-8");const i={loaders:I(e),action:e.sharedMap.get(C),status:t!==200?t:200,href:re(e.url,n),redirect:a??void 0},o=e.getWritableStream().getWriter(),f=await e[v]._serializeData(i,!0);o.write($.encode(f)),e.sharedMap.set("qData",i),o.close()}}function Be(e){if(e.startsWith("/")){const r=R,t=new URL(e,"http://localhost");return(t.pathname.endsWith("/")?t.pathname.slice(0,-1):t.pathname)+(r.startsWith("/")?"":"/")+r+t.search}else return}function Y(){return typeof performance<"u"?performance.now():0}async function O(e,r,t){const a=Y();try{return await t()}finally{const n=Y()-a;let i=e.sharedMap.get("@serverTiming");i||e.sharedMap.set("@serverTiming",i=[]),i.push([r,n])}}function Je(e,...r){var t;const a=((t=e.get("content-type"))==null?void 0:t.split(/;,/,1)[0].trim())??"";return r.includes(a)}function Ge(e){const r=[];return e==="day"?e=60*60*24:e==="week"?e=60*60*24*7:e==="month"?e=60*60*24*30:e==="year"?e=60*60*24*365:e==="private"?e={private:!0,noCache:!0}:e==="immutable"?e={public:!0,immutable:!0,maxAge:60*60*24*365,staleWhileRevalidate:60*60*24*365}:e==="no-cache"&&(e={noCache:!0}),typeof e=="number"&&(e={maxAge:e,sMaxAge:e,staleWhileRevalidate:e}),e.immutable&&r.push("immutable"),e.maxAge&&r.push(`max-age=${e.maxAge}`),e.sMaxAge&&r.push(`s-maxage=${e.sMaxAge}`),e.noStore&&r.push("no-store"),e.noCache&&r.push("no-cache"),e.private&&r.push("private"),e.public&&r.push("public"),e.staleWhileRevalidate&&r.push(`stale-while-revalidate=${e.staleWhileRevalidate}`),e.staleIfError&&r.push(`stale-if-error=${e.staleIfError}`),r.join(", ")}var ae=Symbol("RequestEvLoaders"),ne=Symbol("RequestEvMode"),ie=Symbol("RequestEvRoute"),v=Symbol("RequestEvQwikSerializer"),se=Symbol("RequestEvTrailingSlash"),C="@actionId",oe="@actionFormData",Ke="@nonce";function Xe(e,r,t,a,n,i,o,s){const{request:f,platform:c,env:u}=e,h=new Map,m=new Me(f.headers.get("cookie")),p=new Headers,g=new URL(f.url);g.pathname.endsWith(R)&&(g.pathname=g.pathname.slice(0,-ce),n&&!g.pathname.endsWith("/")&&(g.pathname+="/"),h.set(A,!0)),h.set("@manifest",a);let y=-1,_=null,H,F=e.locale,w=200;const le=async()=>{for(y++;y<t.length;){const l=t[y],d=l(S);d instanceof Promise&&await d,y++}},k=()=>{if(_!==null)throw new Error("Response already sent")},D=(l,d)=>{if(k(),typeof l=="number"){w=l;const P=S.getWritableStream().getWriter();P.write(typeof d=="string"?$.encode(d):d),P.close()}else if(w=l.status,l.headers.forEach((b,P)=>{p.append(P,b)}),l.body){const b=S.getWritableStream();l.body.pipeTo(b)}else{if(w>=300&&w<400)return new M;S.getWritableStream().getWriter().close()}return j()},j=()=>(y=q,new N),Q={},S={[ae]:Q,[ne]:e.mode,[se]:n,[ie]:r,[v]:o,cookie:m,headers:p,env:u,method:f.method,signal:f.signal,params:(r==null?void 0:r[0])??{},pathname:g.pathname,platform:c,query:g.searchParams,request:f,url:g,basePathname:i,sharedMap:h,get headersSent(){return _!==null},get exited(){return y>=q},get clientConn(){return e.getClientConn()},next:le,exit:j,cacheControl:l=>{k(),p.set("Cache-Control",Ge(l))},resolveValue:async l=>{const d=l.__id;if(l.__brand==="server_loader"&&!(d in Q))throw new Error("You can not get the returned data of a loader that has not been executed for this request.");return Q[d]},status:l=>typeof l=="number"?(k(),w=l,l):w,locale:l=>(typeof l=="string"&&(F=l),F||""),error:(l,d)=>(w=l,p.delete("Cache-Control"),new Z(l,d)),redirect:(l,d)=>{if(k(),w=l,d){const b=d.replace(/([^:])\/{2,}/g,"$1/");d!==b&&console.warn(`Redirect URL ${d} is invalid, fixing to ${b}`),p.set("Location",b)}return p.delete("Cache-Control"),l>301&&p.set("Cache-Control","no-store"),j(),new M},defer:l=>typeof l=="function"?l:()=>l,fail:(l,d)=>(k(),w=l,p.delete("Cache-Control"),{failed:!0,...d}),text:(l,d)=>(p.set("Content-Type","text/plain; charset=utf-8"),D(l,d)),html:(l,d)=>(p.set("Content-Type","text/html; charset=utf-8"),D(l,d)),parseBody:async()=>H!==void 0?H:H=qe(S.request,h,o),json:(l,d)=>(p.set("Content-Type","application/json; charset=utf-8"),D(l,JSON.stringify(d))),send:D,isDirty:()=>_!==null,getWritableStream:()=>{if(_===null){if(e.mode==="dev"){const l=h.get("@serverTiming");l&&p.set("Server-Timing",l.map(d=>`${d[0]};dur=${d[1]}`).join(","))}_=e.getWritableStream(w,p,m,s,S)}return _}};return Object.freeze(S)}function I(e){return e[ae]}function U(e){return e[se]}function Ye(e){return e[ie]}function L(e){return e[ne]}var q=Number.MAX_SAFE_INTEGER,qe=async(e,r,t)=>{var a;const n=e.clone(),i=((a=e.headers.get("content-type"))==null?void 0:a.split(/[;,]/,1)[0].trim())??"";if(i==="application/x-www-form-urlencoded"||i==="multipart/form-data"){const o=await n.formData();return r.set(oe,o),Ve(o)}else{if(i==="application/json")return await n.json();if(i==="application/qwik-json")return t._deserializeData(await n.text())}},Ve=e=>{const r={};return e.forEach((t,a)=>{const n=a.split(".").filter(o=>o);let i=r;for(let o=0;o<n.length;o++){let s=n[o];o===n.length-1?s.endsWith("[]")?(s=s.slice(0,-2),i[s]=i[s]||[],i[s].push(t)):i[s]=t:i=i[s]={...i[s]}}}),r};function Ze(e,r,t,a,n=!0,i="/",o){let s;const f=new Promise(u=>s=u),c=Xe(e,r,t,a,n,i,o,s);return{response:f,requestEv:c,completion:Ee(c,s)}}async function Ee(e,r){try{await e.next()}catch(t){if(t instanceof M)await e.getWritableStream().close();else if(t instanceof Z){if(console.error(t),!e.headersSent){const a=be(t.status,t),n=t.status;e.html(n,a)}}else if(!(t instanceof N)){if(L(e)!=="dev")try{e.headersSent||(e.headers.set("content-type","text/html; charset=utf-8"),e.cacheControl({noCache:!0}),e.status(500));const a=e.getWritableStream();if(!a.locked){const n=a.getWriter();await n.write($.encode(E(500,"Internal Server Error"))),await n.close()}}catch{console.error("Unable to render error page")}return t}}finally{e.isDirty()||r(null)}}function et(e,r){if(e.endsWith(R)){const t=e.length-ce+(r?1:0);e=e.slice(0,t),e===""&&(e="/")}return e}var A="@isQData",R="/q-data.json",ce=R.length,tt=async(e,r,t,a)=>{if(Array.isArray(e))for(const n of e){const i=n[0].exec(a);if(i){const o=n[1],s=at(n[2],i),f=n[4],c=new Array(o.length),u=[],h=rt(r,a);let m;return o.forEach((p,g)=>{V(p,u,y=>c[g]=y,t)}),V(h,u,p=>m=p==null?void 0:p.default,t),u.length>0&&await Promise.all(u),[s,c,m,f]}}return null},V=(e,r,t,a)=>{if(typeof e=="function"){const n=B.get(e);if(n)t(n);else{const i=e();typeof i.then=="function"?r.push(i.then(o=>{a!==!1&&B.set(e,o),t(o)})):i&&t(i)}}},rt=(e,r)=>{if(e){r=r.endsWith("/")?r:r+"/";const t=e.find(a=>a[0]===r||r.startsWith(a[0]+(r.endsWith("/")?"":"/")));if(t)return t[1]}},at=(e,r)=>{const t={};if(e)for(let a=0;a<e.length;a++){const n=(r==null?void 0:r[a+1])??"",i=n.endsWith("/")?n.slice(0,-1):n;t[e[a]]=decodeURIComponent(i)}return t};async function nt(e,r,t){const{render:a,qwikCityPlan:n,manifest:i,checkOrigin:o}=r,s=e.url.pathname,f=et(s,n.trailingSlash),c=await it(n,f,e.request.method,o??!0,a);return c?Ze(e,c[0],c[1],i,n.trailingSlash,n.basePathname,t):null}async function it(e,r,t,a,n){const{routes:i,serverPlugins:o,menus:s,cacheModules:f}=e,c=await tt(i,s,f,r),u=ve(o,c,t,a,Ne(n));return u.length>0?[c,u]:null}function st(e){const r={_deserializeData:de,_serializeData:he,_verifySerializable:pe};e.manifest&&ge(e.manifest);async function t(a,n){try{const i=new URL(a.url);if(ue(a.method,i)||i.pathname.startsWith("/.netlify"))return n.next();const o={mode:"server",locale:void 0,url:i,env:Deno.env,request:a,getWritableStream:(c,u,h,m)=>{const{readable:p,writable:g}=new TransformStream,y=new Response(p,{status:c,headers:We(u,h)});return m(y),g},getClientConn:()=>{var c;return{ip:n.ip,country:(c=n.geo.country)==null?void 0:c.code}},platform:n},s=await nt(o,e,r);if(s){s.completion.then(u=>{u&&console.error(u)});const c=await s.response;if(c)return c}const f=fe(i.pathname);return new Response(f,{status:404,headers:{"Content-Type":"text/html; charset=utf-8","X-Not-Found":i.pathname}})}catch(i){return console.error(i),new Response(String(i||"Error"),{status:500,headers:{"Content-Type":"text/plain; charset=utf-8","X-Error":"netlify-edge"}})}}return t}const ut=st({render:ye,qwikCityPlan:me,manifest:we});export{ut as default};
